FROM vm/ubuntu:18.04

# Update and install Python and curl
RUN apt-get update && apt-get install -y python3 curl

# Setup NodeSource for Node.js 12.x and install Node.js
RUN curl -sL https://deb.nodesource.com/setup_12.x | bash -
RUN apt-get install -y nodejs

# Verify Node.js installation
RUN node -v && npm -v

# Install Jest and Puppeteer (ensure versions are compatible with Node.js 12)
RUN npm install -g jest@24 puppeteer@2.1.1

# Setup test files and copy repository contents
RUN echo '<b>some html</b>' > hello.html
RUN echo '<b>another file</b>' > another.html
COPY . .

# Start a simple server in the background
RUN BACKGROUND python3 -m http.server 80
EXPOSE WEBSITE http://localhost:80

