# Use an Ubuntu 18.04 base for our staging server
FROM vm/ubuntu:18.04

# Install Python and necessary tools
RUN apt-get update && apt-get install -y python3 curl

# Install Node.js compatible with Ubuntu 18.04
RUN curl -sL https://deb.nodesource.com/setup_12.x | bash - && \
    apt-get install -y nodejs

# Verify Node.js and npm versions
RUN node -v && npm -v

# Install Jest and Puppeteer for JavaScript testing
RUN npm install --global jest puppeteer

# Copy the repository contents to the VM
COPY . .

# Create test HTML files
RUN echo '<b>some html</b>' > hello.html
RUN echo '<b>another file</b>' > another.html

# Background a simple Python web server
RUN BACKGROUND python3 -m http.server 80

# Ensure the web server port is exposed
EXPOSE WEBSITE http://localhost:80

